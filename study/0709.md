# 유스케이스 구현하기

육각형 아키텍쳐 스타일에서 유스케이스를 구현
육각형 아키텍쳐는 도메인 중심의 아키텍쳐에 적합하기 때문에 엔티티를 만드는 것으로 시작한 후 해당 도메인 엔티티를 중심으로 유스케이스를 구현한다.

### 도메인 모델 구현하기
한 계좌에서 다른 계좌로 송금하는 유스케이스를 구현해보자.

객체 지향적으로 모델링 하는 방법은 입금과 출금을 할 수 있는 Account 엔티티를 만들고 출금 계좌에서 돈을 출금해서 입금 계좌로 돈을 입금하는 것이다.

계좌의 현재 잔고를 계산하기 위해서 Account 엔티티는 활동창의 첫 번째 활동 바로 전의 잔고를 표현하는 baseline Balance 속성을 가지고 있다.

### 유스케이스 역할
입력을 받는다 -> 비즈니스 규칙을 검증한다 -> 모델 상태를 조작한다 -> 출력을 반환한다

유스케이스 코드가 도메인 로직에만 신경 써야 하고 입력 유효성 검증으로 오염되면 안 된다고 생각한다
그래서 입력 유효성 검증은 곧 살펴볼 다른 곳에서 처리한다

하지만, 유스케이스는 비즈니스 규칙을 검증할 책임이 있다. 그리고 도메인 엔티티와 이 책임을 공유한다.

이번 장의 후반부에서 입력 유효성 검증과 비즈니스 규칙 검증의 차이에 대해 살펴보겠다.

> 유스케이스를 구현할 때는 모든 유스케이스를 한 서비스 클래스에 넣지 않고 각 유스케이스별로 분리된 각각의 서비스로 만듭니다

인커밍 포트 인터페이스인 SendMoneyUseCase를 구현하고 계좌를 불러오기 위해
아웃고잉 포트 인터페이스인 LoadAccountPort를 호출한다.

입력 모델의 경우에는 생성자 내에서 입력 유효성을 검증한다

> 생성자 내에서 귀찮게 할 필요 없이 Bean Validation API를 사용해서 필요한 유효성 규칙들을 필드의 애너테이션으로 표현하자

### 생성자의 힘
앞에서 살펴본 입력 모델인 SendMoneyCommand는 생성자에 많은 책임이 존재

### 비즈니스 규칙 검증하가ㅣ
입력 유효성 검증은 유스케이스 로직에 포함되지 않지만, 비즈니스 규칙 검증은 유스케이스 로직의 일부다.

### 유스케이스마다 다른 출력 모델
유스케이스가 할 일을 다하고 나면 호출자에게 무엇을 반환해야 할까
입력과 비슷하게 출력도 가능하면 각 유스케이스에 맞게 구체적일수록 좋다

출력은 호출자에게 꼭 필요한 데이터만 들고 있어야 한다.

송금하기 유스케이스 코드에서는 boolean 값 하나를 반환하낟.

업데이터된 Account를 통째로 반환하고 싶을 수도 있다.


